<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.powerbridge.bssp.ems.dao.EmsPutrecExgMapper">
	<sql id="Base_Column_List">
		A.UID,A.EMS_NO AS EMSNO,A.CHG_TMS_CNT AS CHGTMSCNT,A.GDS_SEQNO AS GDSSEQNO,A.MTPCK_ENDPRD_TYPECD AS MTPCKENDPRDTYPECD,A.GDS_MTNO AS GDSMTNO,A.GDECD AS GDECD
		,A.GDS_NM AS GDSNM,A.ENDPRD_GDS_SPCF_MODEL_DESC AS ENDPRDGDSSPCFMODELDESC,A.DCL_UNITCD AS DCLUNITCD,A.LAWF_UNITCD AS LAWFUNITCD,A.SECD_LAWF_UNITCD AS SECDLAWFUNITCD
		,A.DCL_UPRC_AMT AS DCLUPRCAMT,A.DCL_CURRCD AS DCLCURRCD,A.DCL_QTY AS DCLQTY,A.LVYRLF_MODECD AS LVYRLFMODECD,A.QTY_CNTR_MARKCD AS QTYCNTRMARKCD,A.INVT_NO AS INVTNO,A.INVT_G_NO AS INVTGNO
		,A.ADJMTR_MARKCD AS ADJMTRMARKCD,A.MODF_MARKCD AS MODFMARKCD,A.ETPS_EXE_MARKCD AS ETPSEXEMARKCD,A.CUSM_EXE_MARKCD AS CUSMEXEMARKCD,A.CSTTN_FLAG AS CSTTNFLAG
		,A.APPR_MAX_SURP_QTY AS APPRMAXSURPQTY,A.VCLR_PRID_INIT_QTY AS VCLRPRIDINITQTY,A.UCNS_TQSN_FLAG AS UCNSTQSNFLAG,A.ETPS_PREENT_NO AS ETPSPREENTNO,A.RMK AS RMK
		,A.SEQ_NO AS SEQNO,A.CREATE_BY AS CREATEBY,A.CREATE_NAME AS CREATENAME,A.CREATE_TIME AS CREATETIME,A.UPDATE_BY AS UPDATEBY,A.UPDATE_NAME AS UPDATENAME,A.UPDATE_TIME AS UPDATETIME
		,B.ATTR_NAME AS ADJMTRMARKNM,C.ATTR_NAME AS MODFMARKNM,D.ATTR_NAME AS ETPSEXEMARKNM,E.UNIT_NAME AS DCLUNITNM,F.UNIT_NAME AS LAWFUNITNM,G.CURR_NAME AS DCLCURRNM
	</sql>
	<select id="selectEmsPutrecExgList" resultType="com.powerbridge.bssp.ems.entity.EmsPutrecExg">
		SELECT
		<include refid="Base_Column_List"/>
		FROM EMS_PUTREC_EXG A
		LEFT JOIN BSSP_COD.COD_STD_CODES B ON B.ATTR_VALUE = A.ADJMTR_MARKCD AND B.DICTIONARY_VALUE='ADJMTR_MARKCD' <!--辅料标记-->
		LEFT JOIN BSSP_COD.COD_STD_CODES C ON C.ATTR_VALUE=A.MODF_MARKCD AND C.DICTIONARY_VALUE='MODF_MARK' <!-- 修改标记-->
		LEFT JOIN BSSP_COD.COD_STD_CODES D ON D.ATTR_VALUE=A.ETPS_EXE_MARKCD AND D.DICTIONARY_VALUE='ETPS_EXE_MARK' <!-- 企业执行标记-->
		LEFT JOIN BSSP_COD.COD_CUS_UNIT E ON A.DCL_UNITCD=E.UNIT_CODE <!-- 申报计量单位-->
		LEFT JOIN BSSP_COD.COD_CUS_UNIT F ON A.LAWF_UNITCD=F.UNIT_CODE <!-- 法定计量单位-->
		LEFT JOIN BSSP_COD.COD_CUS_CURR G ON A.DCL_CURRCD=G.CURR_CODE <!-- 申报币制-->
		WHERE A.SEQ_NO = #{seqNo}  AND A.CHG_TMS_CNT = #{chgTmsCnt}
	</select>
	<!-- 获取最大的商品序号-->
	<select id="getMaxGdsSeqno" resultType="java.math.BigDecimal">
		SELECT IFNULL(MAX(GDS_SEQNO),0) AS GDSSEQNO
		FROM EMS_PUTREC_EXG
		WHERE SEQ_NO = #{seqNo} <!-- 单据编号-->
	</select>
</mapper>
